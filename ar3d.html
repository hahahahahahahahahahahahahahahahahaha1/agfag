<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AR 3D Model Viewer</title>

<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
<script src="script.js"></script>

<style>
body { margin: 0; }
#controls {
  position: absolute;
  top: 10px; left: 10px; z-index: 999;
  background: rgba(255,255,255,0.8);
  padding: 10px; border-radius: 8px;
}
button { margin-top: 5px; display:block; }
</style>
</head>

<body>

<div id="controls">
  <label>Select 3D Model</label>
  <select id="modelSelect"></select>
  <button onclick="loadARModel()">Load in AR</button>
</div>

<a-scene mindar-image="imageTargetSrc: artist1.mind; maxTrack: 1;"
         vr-mode-ui="enabled: false"
         device-orientation-permission-ui="enabled: true"
         embedded
         color-space="sRGB"
         renderer="colorManagement: true;">
  <a-assets>
    <a-asset-item id="arModelAsset" src=""></a-asset-item>
  </a-assets>

  <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

  <a-entity mindar-image-target="targetIndex: 0">
    <a-gltf-model id="arModel" src="#arModelAsset" rotation="0 0 0" scale="0.5 0.5 0.5" position="0 0 0"></a-gltf-model>
  </a-entity>
</a-scene>

<script>
if(!localStorage.getItem("currentUser")) window.location.href="login.html";

const modelSelect = document.getElementById("modelSelect");
const artist = getArtistData();
if(artist && artist.models){
  artist.models.forEach((m,i) => {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = m.title;
    modelSelect.appendChild(opt);
  });
}

function loadARModel(){
  const index = modelSelect.value;
  if(!artist.models || !artist.models[index]) return alert("No model selected!");
  const url = artist.models[index].url;
  document.getElementById("arModelAsset").setAttribute("src", url);
  document.getElementById("arModel").setAttribute("src","#arModelAsset");
  alert("3D model loaded! Point camera at target image.");
}
</script>

</body>
</html>
